--create SCHEMA Map

CREATE TABLE myDW.[Map].Part (
	ProcessID int NULL,
	TL_Part_No nvarchar(50) NULL,
	Plex_Part_No varchar(8) NOT NULL,
	Revision varchar(1) NOT NULL,
	Operation_Code varchar(16) NOT NULL
);
*/
insert into TL_Plex_PN_Op_Map_Plant6 
values
-- (62576,'10103344','10103344','A','Machine A - WIP')  -- 62576|DANA    |10103344H P558 7K RH KNUCKLE|10103344H |1ST OP HORIZONTAL MILL|

/*
 * This table can be used to validate whether or not the all the
 * parts in the PRP have a account_job to that can be assigned
 * to an item_usage MRO withdrawal
 */
CREATE TABLE myDW.[Map].Part (

	PCN int NOT NULL,
	part_key int NOT NULL,
	accounting_job_key int NOT NULL
}

insert into myDW.[Map].Part
values
(300758, 23564, 0)  -- DANA-10103344H P558 7K RH KNUCKLE

-- drop TABLE myDW.[Map].PartOp 
/*
 * All of the Plex.Part.Tool_Assembly_Part records Tool_BOMs will have restrictions 
 * under the MSC job with this description.
 */
CREATE TABLE myDW.[Map].Tool_Part_Op (
	PCN int NOT NULL,
	original_process_id int NOT NULL,
	process_id int NOT NULL,
	part_key int NOT NULL,
	operation_key int NOT NULL,
	MSC_descr nvarchar(50)
);
select * from [Map].Part

select * from AlbSPS.Jobs j 

-- TRUNCATE table  myDW.Map.Tool_Part_Op
INSERT INTO myDW.[Map].Tool_Part_Op
(PCN, original_process_id,part_key, accounting_job_key, part_key)
VALUES
--Tool List, DANA 10013354 P558 6K RH KNUCKLE
-- Plex	10103353
(300758,23726,62576,2820292,51168,'DANA-10103344H P558 7K RH KNUCKLE')  -- uploaded
(300758,23564,54536,2820292,56035,'DANA-10103344 Vert P558 7K RH KNUCKLE') -- uploaded
(300758,28079,61763,2820294,56035,'DANA 10103351H P558 7K LH KNUCKLE')  -- uploaded
-- (300758,4912	54529,2820294,56035,'DANA 10103351 P558 7K LH KNUCKLE')  -- There is only one of these tool list in the Plex tooling module?
(300758,54484,61747, 2794731, 51168,'DANA - 10103353H P558 6K RH'),  -- uploaded
(300758,54480,54480, 2794731, 56035,'DANA - 10103353 DANA 6K RH VERT'),  -- uploaded 
(300758,54484,61747, 2820236, 51168,'DANA - 10103353H P558 6K RH'),  -- 10103353CX parts 
(300758,54480,54480, 2820236, 56035,'DANA - 10103353 DANA 6K RH VERT'),  -- 10103353CX parts



(300758, 54485, 105728, 2794706),  -- DANA - 10103355H DANA P558 6K LH
(300758, 54479, 105728, 2794706)  -- DANA - 10103355 DANA 6K LH VERT
-- (PCN, original_process_id, accounting_job_key, part_key)

(300758, 12876, , 2812248), --12876	DANA - 48439 SERVICE KNUCKLE, What tlg# for RH Service Knuckle pn#48439
(300758, 12883, 0, 0)
(300758, 28078, 105727, 2794731) --DANA 10013354 P558 6K RH KNUCKLE, Plex	10103353
(300758, 0, 0, 0)

--12876	DANA - 48439 SERVICE KNUCKLE
12883	DANA - 51355 SERVICE KNUCKLE
12887	DANA - 2009490H 6K KNUCKLE
12888	DANA - 2009828 6K KNUCKLE
12893	DANA - 2015683H 6K KNUCKLE
12916	DANA - 2009828 6K KNUCKLE
12932	DANA - 2004915H RH 7K KNUCKLE
12935	DANA - 2004915 7K KNUCKLE
13077	DANA - 2015685H 6K KNUCKLE
191	USM - 53379 GMT560 YOKE
23564	DANA-10103344 P558 7K RH KNUCKLE
23726	DANA-10103344H P558 7K RH KNUCKLE
24001	DANA 10037973H P558 6K LH KNUCKLE
26029	DANA 10037973 P558 6K LH KNUCKLE
28077	DANA 10013354H P558 6K RH KNUCKLE
28078	DANA 10013354 P558 6K RH KNUCKLE
28079	DANA 10103351H P558 7K LH KNUCKLE
28080	DANA 10103351 P558 7K LH KNUCKLE
4774	DANA - 2004916 7K KNUCKLE
4912	DANA - 10103351H LH 7K KNUCKLE
54479	DANA - 10103355 DANA 6K LH VERT
54480	DANA - 10103353 DANA 6K RH VERT
54484	DANA - 10103353H P558 6K RH
54485	DANA - 10103355H DANA P558 6K LH
MARKER	MARKER
/*
	PCN
	310507/Avilla
	300758/Albion
	295933/Franklin
	300757/Alabama
	306766/Edon
	312055/ BPG WorkHolding
	1	123681
2	295932 Fruit Port
3	295933
4	300757
5	300758
6	306766
7	310507
8	312055
*/
